defpackage pin-state-test :
  import core
  import collections
  import rtm/utils
  import pin-state

public defn main () :
  ;Group with one config
  defn C (pins:Tuple<Int>) :
    Config(pins,false)
  defn G (pins:Tuple<Int>) :
    Group([Config(pins,false)])
  defn G (cfgs:Tuple<Config>) :
    Group(cfgs)

  val ps = PinState(6, [
    Class $ [
      G $ [0 1]   ;0
      G $ [0 2]   ;1
      G $ [0 3]   ;2
      G $ [0 4]   ;3
      G $ [1 2]   ;4
      G $ [3 2]   ;5
      G $ [4 2]   ;6
      G $ [5 2]]  ;7
    Class $ [
      G $ [3]     ;8
      G $ [4]     ;9
      G $ [5]]])  ;10

  defn RQ (c:Int, ps:Tuple<Int|False>) :
    AllocRequest(false, c, ps)
  do{println, _} $
    allocate(ps,
      [RQ(0, [false 2])
       RQ(0, [0 false])       
       RQ(1, [false])
       RQ(1, [false])])

main()